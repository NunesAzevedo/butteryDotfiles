# ==============================================================================
# TOPGRADE CONFIGURATION
# Otimizado para Fedora + Arch (dual boot com /home compartilhado)
# Desenvolvimento: Rob√≥tica, C++, Python
# Localiza√ß√£o: ~/.config/topgrade.toml
# Refer√™ncia: https://github.com/topgrade-rs/topgrade
# ==============================================================================

[misc]
# Cachear credenciais sudo no in√≠cio (evita prompts no meio da atualiza√ß√£o)
pre_sudo = true

# Assumir "yes" para prompts (equivalente ao -y)
assume_yes = true

# N√£o perguntar para retry em caso de falha
no_retry = false

# Mostrar t√≠tulo no terminal
set_title = true

# Mostrar tempo em cada step
display_time = true

# ============================================
# üßπ LIMPEZA AUTOM√ÅTICA (ap√≥s atualiza√ß√µes)
# ============================================
# Remove arquivos tempor√°rios e cache antigo
cleanup = true

# Ignorar falhas em passos espec√≠ficos
ignore_failures = ["containers"]

# ==============================================================================
# P√ìS-COMANDOS - LIMPEZA (executados AP√ìS as atualiza√ß√µes)
# Mant√©m as √∫ltimas 3 vers√µes de kernels/pacotes
# ==============================================================================
[post_commands]
# --- FEDORA ---
# DNF j√° respeita installonly_limit=3 do /etc/dnf/dnf.conf para kernels
"Fedora: DNF Autoremove" = "command -v dnf >/dev/null && sudo dnf autoremove -y || true"
"Fedora: DNF Clean" = "command -v dnf >/dev/null && sudo dnf clean all || true"

# --- ARCH ---
# paccache -rk3 mant√©m as √∫ltimas 3 vers√µes de cada pacote no cache
"Arch: Pacman Cache (manter 3 vers√µes)" = "command -v paccache >/dev/null && sudo paccache -rk3 || true"
"Arch: Remover pacotes √≥rf√£os" = "command -v pacman >/dev/null && sudo pacman -Rns $(pacman -Qdtq) 2>/dev/null || true"

# --- COMUM (ambas distros) ---
"Flatpak: Remover runtimes n√£o usados" = "flatpak uninstall --unused -y 2>/dev/null || true"
"Journal: Limpar logs >7 dias" = "sudo journalctl --vacuum-time=7d 2>/dev/null || true"

# ==============================================================================
# LINUX/FEDORA/ARCH
# ==============================================================================
[linux]
# Arch: usar yay como AUR helper
arch_package_manager = "yay"

# Argumentos para yay (n√£o atualizar pacotes -devel)
yay_arguments = "--nodevel"

# ==============================================================================
# FLATPAK
# ==============================================================================
[flatpak]
use_sudo = true

# ==============================================================================
# FIRMWARE
# ==============================================================================
[firmware]
upgrade = true

# ==============================================================================
# GIT REPOSITORIES
# ==============================================================================
[git]
max_concurrency = 5
arguments = "--rebase --autostash"

# ==============================================================================
# CONTAINERS (Docker)
# ==============================================================================
[containers]
runtime = "docker"

# ==============================================================================
# NPM
# ==============================================================================
[npm]
use_sudo = false

# ==============================================================================
# VIM / NEOVIM
# ==============================================================================
[vim]
force_plug_update = true